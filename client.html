<html>
	<head>
	<!-- 
	 * Author:		Gianluca Guarini
	 * Contact: 	gianluca.guarini@gmail.com
	 * Website:		http://www.gianlucaguarini.com/
	 * Twitter:		@gianlucaguarini
	-->
		<title>Push notification server streaming on a MySQL db</title>
		<style>
			dd,dt {
				float:left;
				margin:0;
				padding:5px;
				clear:both;
				display:block;
				width:100%;

			}
			dt {
				background:#ddd;
			}
			time {
				color:gray;
			}
		</style>
	</head>
	<body>
        <time></time>
        <div id="container">Loading ...</div>
    <script src="socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <div class="checkBoxUserContainer"></div>
    <div class="checkBoxFieldContainer"></div>
    <div class="notificationContainer"></div>
    <script>

        // create a new websocket
        var socket = io.connect('http://localhost:8000');
        // on message received we print all the data inside the #container div
        

      	socket.on('ehlo' , function(data){
//       				        var checkbox = document.createElement('input');
// checkbox.type = "checkbox";
// checkbox.name = "name";
// checkbox.value = "value";
// checkbox.id = "id";

// var label = document.createElement('label')
// label.htmlFor = "id";
// label.appendChild(document.createTextNode('text for label after checkbox'));

// container.appendChild(checkbox);
// container.appendChild(label);
console.log(data)
var usersArray =[];
var filedArray = ["name" , "description" , "image"];
	$.each(data.users,function(index,user){
		usersArray.push(user.user_name)

	});

	$(document).ready(function(){


			$.each(usersArray,function(index,value){
				var checkbox="<label for="+value+">"+value+"</label><input type='checkbox' id="+value+" value="+value+" name= 'user'>"
				$(".checkBoxUserContainer").append($(checkbox));
			})

			$.each(filedArray,function(index,value){
				var checkbox="<label for="+value+">"+value+"</label><input type='checkbox' id="+value+" value="+value+" name= 'field'>"
				$(".checkBoxFieldContainer").append($(checkbox));
			})


	});

	socket.on('notification', function (data) {
		        var usersList = "<dl>";
		        $.each(data.users,function(index,user){
		            usersList += "<dt>" + user.user_name + "</dt>\n" +
		                         "<dd>" + user.user_description + "\n" +
		                            "<figure> <img class='img-polaroid' width='50px' src='" + user.user_img + "' /></figure>"
		                         "</dd>";
		        });
		        usersList += "</dl>";
		        $(".notificationContainer").html($(usersList));


		        var userChecked = [];
            	$.each($("input[name='user']:checked"), function(){            
                	userChecked.push($(this).val());
            	});
            	var filedChecked = [];
            	$.each($("input[name='field']:checked"), function(){            
                	filedChecked.push($(this).val());
            	});
            	console.log(userChecked)
            	console.log(filedChecked)
            	// alert("My favourite sports are: " + favorite.join(", "));
		        // $('#container').html(usersList);
		   
		        // $('time').html('Last Update:' + data.time);

      	});


      	})


    </script>
    </body>
</html>